\documentclass{article}
\usepackage{agda}
\usepackage{amsmath}
\usepackage{mathpartir}


%include agda.fmt
%include unicode.fmt

\begin{document}
\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaComment{-- Universal Algebra Library}\<%
\\
\>[0]\AgdaComment{--}\<%
\\
\>[0]\AgdaComment{-- Morphisms: Homomorphism, Homo composition and equality,}\<%
\\
\>[0]\AgdaComment{--  Isomorphism, Initial and Final Algebras,}\<%
\\
\>[0]\AgdaComment{--  Homomorphic image, Kernel of a congruence.}\<%
\\
\>[0]\AgdaComment{--}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{UnivAlgebra}\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Morphisms}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{Σ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Signature}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSymbol{;}\AgdaRecord{Σ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{F}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Bijective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Surjective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaRecord{Bijection}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaRecord{Surjection}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Injective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaRecord{Injection}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Equality}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{FE}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘ₛ\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{setoid}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Level}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{suc}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{lsuc}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{zero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{lzero}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Total}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.Indexed.Homogeneous}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{IRel}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{PE}\<%
\\
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.EqReasoning}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{EqR}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Unary}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{HeterogeneousVec}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Setoids}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{∥\AgdaUnderscore{}∥}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Setoid}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Homomorphism from A to B -\}}\<%
\\
\>[0]\AgdaKeyword{module}%
\>[69I]\AgdaModule{Hom}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[69I]%
\>[7]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\<%
\\
%
\>[7]\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaComment{-- Function between algebras}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⟿\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⟿\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟶}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{-- Map}\<%
\\
%
\>[2]\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ar}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Arity}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⟿\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ts}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
\AgdaBound{ar}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥*}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
\AgdaBound{ar}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥*}}\<%
\\
%
\>[2]\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{ar}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ar}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ts}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{--Homomorphism condition}\<%
\\
%
\>[2]\AgdaFunction{homCond}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⟿\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[2]\AgdaFunction{homCond}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ar}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ops}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ar}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{as}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
\AgdaBound{ar}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥*}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}≈ₛ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaKeyword{in}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{≈ₛ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{\{- Homomorphism -\}}\<%
\\
%
\>[2]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{lsuc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{field}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaField{′\AgdaUnderscore{}′}}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⟿\AgdaUnderscore{}}}\<%
\\
%
\>[6]\AgdaField{cond}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{homCond}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′\AgdaUnderscore{}′}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Homo}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{ExtEq}\<%
\\
%
\>[2]\AgdaComment{\{- Equality of homomorphisms -\}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈ₕ\AgdaUnderscore{}}}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{H}\AgdaSpace{}%
\AgdaBound{G}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[2]\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≈ₕ}}\AgdaSpace{}%
\AgdaBound{G}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≈→}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{G}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{≈A→B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{IsEquivalence}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈→\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{\})}\<%
\\
%
\>[2]\AgdaFunction{≈A→B}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Equiv≈→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{≈ₕ-setoid}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Setoid}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{lsuc}\AgdaSpace{}%
\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaPrimitive{lsuc}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaPrimitive{lsuc}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaPrimitive{lsuc}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{≈ₕ-setoid}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{Carrier}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{Homo}\<%
\\
%
\>[4]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈ₕ\AgdaUnderscore{}}}\<%
\\
%
\>[4]\AgdaSymbol{;}%
\>[286I]\AgdaField{isEquivalence}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\<%
\\
\>[.][@{}l@{}]\<[286I]%
\>[6]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{\{}x \AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{h}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{sym}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{trans}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Hom.Homo}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Hom}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Homomorphism composition -\}}\<%
\\
\>[0]\AgdaKeyword{module}%
\>[339I]\AgdaModule{HomComp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaBound{l₅}\AgdaSpace{}%
\AgdaBound{l₆}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[339I]%
\>[7]\AgdaSymbol{\{}\AgdaBound{A₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\<%
\\
%
\>[7]\AgdaSymbol{\{}\AgdaBound{A₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\<%
\\
%
\>[7]\AgdaSymbol{\{}\AgdaBound{A₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l₅}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l₆}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘ₕ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{H}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A₁}\AgdaSpace{}%
\AgdaBound{A₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{H₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₂}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘ₕ\AgdaUnderscore{}}}%
\>[8]\AgdaBound{H₁}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′\AgdaUnderscore{}′}}%
\>[12]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{comp}\<%
\\
%
\>[4]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cond}%
\>[12]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{∘ₕcond}\<%
\\
%
\>[4]\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaKeyword{where}\<%
\\
%
\>[4]\AgdaFunction{comp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟿}}\AgdaSpace{}%
\AgdaBound{A₂}\<%
\\
%
\>[4]\AgdaFunction{comp}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₛ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{∘ₕcond}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{homCond}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₂}\AgdaSpace{}%
\AgdaFunction{comp}\<%
\\
%
\>[4]\AgdaFunction{∘ₕcond}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ar}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{as}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{comp}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{cond}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[6]\AgdaOperator{\AgdaField{′}}%
\>[429I]\AgdaBound{H₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[429I]%
\>[8]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaBound{H₁}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[6]\AgdaBound{A₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map⟿}%
\>[27]\AgdaBound{A₁}\AgdaSpace{}%
\AgdaBound{A₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaFunction{propMapMorph}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[6]\AgdaBound{A₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₂}\AgdaSpace{}%
\AgdaFunction{comp}\AgdaSpace{}%
\AgdaBound{as}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[6]\AgdaKeyword{where}\<%
\\
%
\>[6]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{EqR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{propMapMorph}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[22]\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[6]\AgdaFunction{propMapMorph}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{≡to≈}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaFunction{PE.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaFunction{map-compose}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSymbol{)}%
\>[44]\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{infixr}\AgdaSpace{}%
\AgdaNumber{21}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘ₕ\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Homomorphism identity -\}}\<%
\\
\>[0]\AgdaFunction{HomId}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Hom.Homo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[0]\AgdaFunction{HomId}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′\AgdaUnderscore{}′}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{FE.id}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{\{}%
\>[544I]\AgdaSymbol{\{}\AgdaBound{ar}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{as}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[544I]%
\>[15]\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\<%
\\
%
\>[15]\AgdaSymbol{(}\AgdaFunction{≡to∼v}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{isEquivalence}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{))}\<%
\\
%
\>[15]\AgdaSymbol{(}\AgdaFunction{PE.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map-id}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Homomorphism composition properties -\}}\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{HomCompProp}%
\>[565I]\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaBound{ℓ₅}\AgdaSpace{}%
\AgdaBound{ℓ₆}\AgdaSpace{}%
\AgdaBound{ℓ₇}\AgdaSpace{}%
\AgdaBound{ℓ₈}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[565I]%
\>[19]\AgdaSymbol{\{}\AgdaBound{A₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\<%
\\
%
\>[19]\AgdaSymbol{\{}\AgdaBound{A₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\<%
\\
%
\>[19]\AgdaSymbol{\{}\AgdaBound{A₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₅}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₆}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\<%
\\
%
\>[19]\AgdaSymbol{\{}\AgdaBound{A₃}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₇}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₈}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\<%
\\
%
\>[19]\AgdaSymbol{\{}\AgdaBound{H₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Hom.Homo}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₁}\AgdaSymbol{\}}\<%
\\
%
\>[19]\AgdaSymbol{\{}\AgdaBound{H₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Hom.Homo}\AgdaSpace{}%
\AgdaBound{A₁}\AgdaSpace{}%
\AgdaBound{A₂}\AgdaSymbol{\}}\<%
\\
%
\>[19]\AgdaSymbol{\{}\AgdaBound{H₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Hom.Homo}\AgdaSpace{}%
\AgdaBound{A₂}\AgdaSpace{}%
\AgdaBound{A₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Hom}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Homo}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{HomComp}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{H₀}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaModule{Hom}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₁}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈ₕ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈ₕ₀\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{HComp}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaModule{Hom}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₃}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈ₕ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈ₕ₃\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaOperator{\AgdaFunction{idR\AgdaUnderscore{}prop}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{H₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaFunction{HomId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≈ₕ₀}}\AgdaSpace{}%
\AgdaBound{H₀}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{idR\AgdaUnderscore{}prop}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[638I]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[.][@{}l@{}]\<[638I]%
\>[17]\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaFunction{HomId}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\>[17]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaFunction{Setoid.refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[17]\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\>[17]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{EqR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaOperator{\AgdaFunction{idL\AgdaUnderscore{}prop}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{HomId}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≈ₕ₀}}\AgdaSpace{}%
\AgdaBound{H₀}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{idL\AgdaUnderscore{}prop}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[672I]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[.][@{}l@{}]\<[672I]%
\>[17]\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaFunction{HomId}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\>[17]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaFunction{Setoid.refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[17]\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\>[17]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{EqR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaOperator{\AgdaFunction{assoc\AgdaUnderscore{}prop}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{H₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaBound{H₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≈ₕ₃}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{H₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{H₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{assoc\AgdaUnderscore{}prop}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[712I]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[.][@{}l@{}]\<[712I]%
\>[19]\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{H₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaBound{H₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\>[19]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaFunction{Setoid.refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₃}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[19]\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{H₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaBound{H₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\>[19]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{EqR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₃}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Isomorphism -\}}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Bijection}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘b\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Surjection}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Bijective}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Hom}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Homo}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Homomorphism inverse -\}}\<%
\\
\>[0]\AgdaFunction{invHomo}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[757I]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[757I]%
\>[10]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{bj}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Bijective}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[10]\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[0]\AgdaFunction{invHomo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{bj}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′\AgdaUnderscore{}′}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{h⁻¹}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cond⁻¹}\<%
\\
%
\>[2]\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟿}}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\>[2]\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[11]\AgdaFunction{from}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{bj}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{cond⁻¹}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{homCond}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaFunction{h⁻¹}\<%
\\
%
\>[2]\AgdaFunction{cond⁻¹}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ar}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{as}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{≈⟨}}%
\>[835I]\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\<%
\\
\>[835I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaFunction{∼↑v}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{a'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Setoid.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{right-inverse-of}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{bj}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{a'}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaBound{as}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[4]\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{a'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a'}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{≈⟨}}%
\>[879I]\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[879I]%
\>[9]\AgdaSymbol{(}\AgdaFunction{Setoid.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟦\AgdaUnderscore{}⟧ₛ}}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{✳}}\AgdaSpace{}%
\AgdaBound{ar}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{≡to≈}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟦\AgdaUnderscore{}⟧ₛ}}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{✳}}\AgdaSpace{}%
\AgdaBound{ar}\AgdaSymbol{)}%
\>[896I]\AgdaSymbol{(}\AgdaFunction{map-compose}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{h⁻¹}\AgdaSymbol{)}\<%
\\
\>[896I][@{}l@{\AgdaIndent{0}}]%
\>[66]\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{))))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[4]\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{))}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Setoid.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{cond}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[4]\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)))}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaFunction{left-inverse-of}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{bj}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[4]\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaBound{as}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[4]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{EqR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Isomorphism -\}}\<%
\\
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Isomorphism}%
\>[1004I]\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[1004I]%
\>[19]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}%
\>[1010I]\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[1010I][@{}l@{\AgdaIndent{0}}]%
\>[36]\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{lsuc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{field}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{hom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A'}\<%
\\
%
\>[4]\AgdaField{bij}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Bijective}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Isomorphism}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Isomorphic algebras -\}}\<%
\\
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{\AgdaUnderscore{}≅\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}%
\>[1047I]\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1047I]%
\>[15]\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{lsuc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{constructor}\AgdaSpace{}%
\AgdaInductiveConstructor{≅⁺}\<%
\\
%
\>[2]\AgdaKeyword{field}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{iso}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaOperator{\AgdaModule{\AgdaUnderscore{}≅\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- The relation of isomorphism between algebras is an equivalence relation -\}}\<%
\\
\>[0]\AgdaFunction{reflIso}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Reflexive}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\})}\<%
\\
\>[0]\AgdaFunction{reflIso}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}%
\>[1096I]\AgdaField{hom}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{HomId}\<%
\\
\>[1096I][@{}l@{\AgdaIndent{0}}]%
\>[30]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{bij}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[1105I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{injective}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{F.id}\<%
\\
\>[1105I][@{}l@{\AgdaIndent{0}}]%
\>[52]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{surjective}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{surj}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1115I]\AgdaFunction{surj}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Surjective}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaFunction{HomId}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1115I]%
\>[8]\AgdaFunction{surj}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[1133I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{FE.id}\<%
\\
\>[.][@{}l@{}]\<[1133I]%
\>[24]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{right-inverse-of}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Setoid.refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{symIso}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[1149I]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\<%
\\
\>[1149I][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[10]\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[0]\AgdaFunction{symIso}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[1181I]\AgdaFunction{h⁻¹}\<%
\\
\>[.][@{}l@{}]\<[1181I]%
\>[31]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{bij}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{bij⁻¹}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1186I]\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[.][@{}l@{}]\<[1186I]%
\>[8]\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{invHomo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{hom}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{bij}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{surj⁻¹}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Surjective}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{surj⁻¹}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[1213I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
\>[.][@{}l@{}]\<[1213I]%
\>[26]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{right-inverse-of}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{left-inverse-of}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{bij}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\>[26]\AgdaSymbol{\}}\<%
\\
%
\>[8]\AgdaFunction{bij⁻¹}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Bijective}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{bij⁻¹}%
\>[1238I]\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[1241I]\AgdaSymbol{\{}%
\>[1242I]\AgdaField{injective}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{h⁻¹x≈h⁻¹y}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[1242I][@{}l@{\AgdaIndent{0}}]%
\>[29]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[29][@{}l@{\AgdaIndent{0}}]%
\>[31]\AgdaBound{x}\<%
\\
%
\>[29]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaFunction{Setoid.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{right-inverse-of}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{bij}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[29][@{}l@{\AgdaIndent{0}}]%
\>[31]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[29]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{h⁻¹x≈h⁻¹y}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[29][@{}l@{\AgdaIndent{0}}]%
\>[31]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaFunction{h⁻¹}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\<%
\\
%
\>[29]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaFunction{right-inverse-of}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{bij}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[29][@{}l@{\AgdaIndent{0}}]%
\>[31]\AgdaBound{y}\<%
\\
%
\>[29]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
\>[.][@{}l@{}]\<[1241I]%
\>[25]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{surjective}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{surj⁻¹}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[1238I]%
\>[14]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{EqR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{transIso}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}%
\>[1309I]\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaBound{ℓ₅}\AgdaSpace{}%
\AgdaBound{ℓ₆}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[1309I]%
\>[13]\AgdaSymbol{(}\AgdaBound{A₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaBound{A₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₅}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₆}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[13]\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaBound{A₁}\AgdaSpace{}%
\AgdaBound{A₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₂}\<%
\\
\>[0]\AgdaFunction{transIso}\AgdaSpace{}%
\AgdaBound{A₀}%
\>[1346I]\AgdaBound{A₁}\AgdaSpace{}%
\AgdaBound{A₂}\AgdaSpace{}%
\AgdaBound{iso₀}\AgdaSpace{}%
\AgdaBound{iso₁}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[1346I]%
\>[12]\AgdaKeyword{record}%
\>[1351I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaBound{iso₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaBound{iso₀}\<%
\\
\>[.][@{}l@{}]\<[1351I]%
\>[19]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{bij}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{bijective}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{bj₁}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘b}}\AgdaSpace{}%
\AgdaFunction{bj₀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1371I]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{HomComp}\<%
\\
\>[.][@{}l@{}]\<[1371I]%
\>[8]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Bijection}\<%
\\
%
\>[8]\AgdaFunction{bj₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Bijection}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{bj₀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[1392I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaBound{iso₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
\>[.][@{}l@{}]\<[1392I]%
\>[23]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{bijective}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{bij}\AgdaSpace{}%
\AgdaBound{iso₀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\>[8]\AgdaFunction{bj₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Bijection}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{bj₁}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[1424I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{to}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaBound{iso₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
\>[.][@{}l@{}]\<[1424I]%
\>[23]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{bijective}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{bij}\AgdaSpace{}%
\AgdaBound{iso₁}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{isoEquiv}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{IsEquivalence}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\})}\<%
\\
\>[0]\AgdaFunction{isoEquiv}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{reflIso}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{sym}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{symIso}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaBound{i}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{trans}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A₀}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{i₀}\AgdaSpace{}%
\AgdaBound{i₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{transIso}\AgdaSpace{}%
\AgdaBound{A₀}\AgdaSpace{}%
\AgdaBound{A₁}\AgdaSpace{}%
\AgdaBound{A₂}\AgdaSpace{}%
\AgdaBound{i₀}\AgdaSpace{}%
\AgdaBound{i₁}\<%
\\
%
\>[2]\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Using an isomorphism -\}}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{HomComp}\<%
\\
\>[0]\AgdaFunction{iso-≈}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}%
\>[1483I]\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[1483I]%
\>[10]\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaBound{H}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaOperator{\AgdaField{Setoid.\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘ₕ}}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{symIso}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaBound{H}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{iso-≈}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Setoid.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{right-inverse-of}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{bij}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1545I]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Surjective}\<%
\\
\>[.][@{}l@{}]\<[1545I]%
\>[8]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Bijective}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}%
\>[1549I]\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Level}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[1549I]%
\>[9]\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\<%
\\
%
\>[9]\AgdaSymbol{\{}\AgdaBound{A'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Hom}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Homo}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Injection}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{HCA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaModule{HomComp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A₀}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘ₕ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘a\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{HCA'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaModule{HomComp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A₀}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘ₕ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘a'\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{HA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaModule{Hom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈ₕ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈a\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Homo}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{HA'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaModule{Hom}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈ₕ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈a'\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Homo}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{iso⁺}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[1621I]\AgdaSymbol{(}\AgdaBound{H}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{H'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A'}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[1621I][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘a'}}\AgdaSpace{}%
\AgdaBound{H'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≈a'}}\AgdaSpace{}%
\AgdaFunction{HomId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{H'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘a}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≈a}}\AgdaSpace{}%
\AgdaFunction{HomId}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A'}\<%
\\
%
\>[2]\AgdaFunction{iso⁺}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaBound{H'}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaBound{eq'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{bij}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{isBij}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}%
\>[1662I]\AgdaFunction{isBij}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Bijective}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1662I]%
\>[10]\AgdaFunction{isInj}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Injective}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaFunction{isSurj}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Surjective}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaFunction{isSurj}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[1693I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
\>[.][@{}l@{}]\<[1693I]%
\>[28]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{right-inverse-of}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
%
\>[28]\AgdaSymbol{\}}\<%
\\
%
\>[10]\AgdaFunction{isInj}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{hx≈hy}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[1709I]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[.][@{}l@{}]\<[1709I]%
\>[34]\AgdaBound{x}\<%
\\
%
\>[34]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaFunction{Setoid.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{eq'}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[34]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[34]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{hx≈hy}%
\>[63]\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[34]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\<%
\\
%
\>[34]\AgdaOperator{\AgdaFunction{≈⟨}}%
\>[38]\AgdaBound{eq'}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[34]\AgdaBound{y}\<%
\\
%
\>[34]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{EqR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaFunction{isBij}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[1758I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{injective}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{isInj}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
\>[.][@{}l@{}]\<[1758I]%
\>[27]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{surjective}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{isSurj}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
%
\>[27]\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Total relation -\}}\<%
\\
\>[0]\AgdaFunction{Total}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Rel}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[0]\AgdaFunction{Total}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{a'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{≈}}\AgdaSpace{}%
\AgdaBound{a'}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{Unique}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Rel}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[0]\AgdaFunction{Unique}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{Total}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- An alternative definition for Unique -\}}\<%
\\
\>[0]\AgdaFunction{Unique'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}%
\>[1817I]\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaBound{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Rel}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[1817I]%
\>[12]\AgdaRecord{IsEquivalence}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[0]\AgdaFunction{Unique'}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{a'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{≈}}\AgdaSpace{}%
\AgdaBound{a'}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Initial Algebra -\}}\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Initial}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Level}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Hom}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Initial}%
\>[18]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{lsuc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{field}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaField{alg}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\<%
\\
%
\>[6]\AgdaField{init}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Unique}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈ₕ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaField{alg}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{private}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{Initial'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[54]\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Level}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[4]\AgdaFunction{Initial'}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Unique}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈ₕ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Final Algebra -\}}\<%
\\
\>[0]\AgdaKeyword{module}%
\>[1915I]\AgdaModule{Final}\<%
\\
\>[1915I][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Level}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Hom}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Final}%
\>[16]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{lsuc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{⊔}}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{field}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaField{alg}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\<%
\\
%
\>[6]\AgdaField{init}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Unique}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≈ₕ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaField{alg}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{SetoidPredicate}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Homomorphic image is a SubAlgebra of B -\}}\<%
\\
\>[0]\AgdaFunction{SubImg}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[1958I]\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[1958I]%
\>[30]\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[30]\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{SubAlg}\AgdaSpace{}%
\AgdaBound{B}\<%
\\
\>[0]\AgdaFunction{SubImg}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{pr}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subipr}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{opClosed}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subicond}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1990I]\AgdaFunction{subiwdef}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}%
\>[1993I]\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{b₀}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b₀}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[1993I]%
\>[21]\AgdaFunction{∃}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[21]\AgdaFunction{∃}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1990I]%
\>[8]\AgdaFunction{subiwdef}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}%
\>[2039I]\AgdaSymbol{\{}\AgdaBound{b₀}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{b₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{eq'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\<%
\\
\>[.][@{}l@{}]\<[2039I]%
\>[21]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[21][@{}l@{\AgdaIndent{0}}]%
\>[28]\AgdaOperator{\AgdaField{′}}%
\>[2048I]\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a}\<%
\\
\>[.][@{}l@{}]\<[2048I]%
\>[30]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaBound{eq'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[28]\AgdaBound{b₀}\<%
\\
\>[28][@{}l@{\AgdaIndent{0}}]%
\>[30]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[28]\AgdaBound{b₁}\<%
\\
\>[21][@{}l@{\AgdaIndent{0}}]%
\>[26]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[21]\AgdaSymbol{)}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{EqR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{subipr}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{SetoidPredicate}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{subipr}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[2077I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{predicate}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{∃}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2077I]%
\>[26]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{predWellDef}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subiwdef}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\>[8]\AgdaFunction{pred}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{predicate}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subipr}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{subicond}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}%
\>[2113I]\AgdaSymbol{\{}\AgdaBound{ar}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ops}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ar}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2113I]%
\>[21]\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}⇨v\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{pred}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨→⟩}}\AgdaSpace{}%
\AgdaField{predicate}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subipr}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\<%
\\
%
\>[21]\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{subicond}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ar}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{v}%
\>[2137I]\AgdaSymbol{=}%
\>[2138I]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaFunction{va}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\<%
\\
\>[.][@{}l@{}]\<[2138I]%
\>[32]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[32][@{}l@{\AgdaIndent{0}}]%
\>[34]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaFunction{va}\AgdaSymbol{)}\<%
\\
%
\>[32]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaFunction{va}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[32][@{}l@{\AgdaIndent{0}}]%
\>[34]\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaFunction{va}\AgdaSymbol{)}\<%
\\
%
\>[32]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{p≈}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[32][@{}l@{\AgdaIndent{0}}]%
\>[34]\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaFunction{proj₁⇨v}\AgdaSpace{}%
\AgdaBound{v}\<%
\\
%
\>[32]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
\>[2137I][@{}l@{\AgdaIndent{0}}]%
\>[31]\AgdaSymbol{)}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{where}%
\>[2185I]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{EqR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2185I]%
\>[16]\AgdaFunction{⇨vΣ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{HVec}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{sᵢ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Σ[}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaFunction{∈}\AgdaSpace{}%
\AgdaField{Carrier}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{sᵢ}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{predicate}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{subipr}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{sᵢ}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ar}\<%
\\
%
\>[16]\AgdaFunction{⇨vΣ}%
\>[21]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{⇨vtoΣ}\AgdaSpace{}%
\AgdaBound{v}\<%
\\
%
\>[16]\AgdaFunction{va}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{HVec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Carrier}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟦\AgdaUnderscore{}⟧ₛ}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ar}\<%
\\
%
\>[16]\AgdaFunction{va}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ha≈b}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaFunction{⇨vΣ}\<%
\\
%
\>[16]\AgdaFunction{p≈}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[2235I]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ar'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{vs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{HVec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Carrier}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟦\AgdaUnderscore{}⟧ₛ}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ar'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2235I]%
\>[21]\AgdaSymbol{(}\AgdaBound{pvs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{pred}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{⇨v}}\AgdaSpace{}%
\AgdaBound{vs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[21]\AgdaSymbol{((}\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟦\AgdaUnderscore{}⟧ₛ}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{✳}}\AgdaSpace{}%
\AgdaBound{ar'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{≈}}\<%
\\
%
\>[21]\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ha≈b}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{⇨vtoΣ}\AgdaSpace{}%
\AgdaBound{pvs}\AgdaSymbol{)))}\<%
\\
%
\>[21]\AgdaBound{vs}\<%
\\
%
\>[16]\AgdaFunction{p≈}\AgdaSpace{}%
\AgdaInductiveConstructor{⇨v⟨⟩}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{∼⟨⟩}\<%
\\
%
\>[16]\AgdaFunction{p≈}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{⇨v▹}\AgdaSpace{}%
\AgdaBound{pv}\AgdaSpace{}%
\AgdaBound{pvs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{∼▹}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaBound{pv}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{p≈}\AgdaSpace{}%
\AgdaBound{pvs}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{homImg}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}%
\>[2289I]\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2289I]%
\>[15]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaBound{Σ}\<%
\\
\>[0]\AgdaFunction{homImg}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SubAlgebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SubImg}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{h}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{-
  The homomorphic image of an isomorphism between algebras A and B is a
  subalgebra isomorphic to B.
-\}}\<%
\\
\>[0]\AgdaFunction{homImg-iso-prop}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}%
\>[2326I]\AgdaSymbol{\{}\AgdaBound{ℓ₀}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2326I]%
\>[20]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₀}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₀}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[20]\AgdaRecord{Isomorphism}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{homImg}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{hom}\AgdaSpace{}%
\AgdaBound{h}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{B}\<%
\\
\>[0]\AgdaFunction{homImg-iso-prop}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₀}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{homAB}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{bij}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{bij}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaKeyword{record}%
\>[2360I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{hom}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[2364I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′\AgdaUnderscore{}′}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{homImgAB-to-B}\<%
\\
\>[.][@{}l@{}]\<[2364I]%
\>[33]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}%
\>[2371I]\AgdaSymbol{\{}\AgdaBound{\AgdaUnderscore{}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{as}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[2371I][@{}l@{\AgdaIndent{0}}]%
\>[45]\AgdaFunction{Setoid.refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{Algebra.⟦}}\AgdaSpace{}%
\AgdaBound{s'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[33]\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[2360I]%
\>[18]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{bij}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[2387I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{injective}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{F.id}\<%
\\
\>[2387I][@{}l@{\AgdaIndent{0}}]%
\>[40]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{surjective}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{homImgAB-to-B-Surj}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
%
\>[40]\AgdaSymbol{\}}\<%
\\
%
\>[18]\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\<%
\\
%
\>[4]\AgdaFunction{homBA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\>[4]\AgdaFunction{homBA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{invHomo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{homAB}\AgdaSpace{}%
\AgdaBound{bij}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{homImgAB-to-B}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[21]\AgdaFunction{homImg}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{homAB}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟿}}\AgdaSpace{}%
\AgdaBound{B}\<%
\\
%
\>[4]\AgdaFunction{homImgAB-to-B}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[2413I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{proj₁}\<%
\\
\>[.][@{}l@{}]\<[2413I]%
\>[29]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cong}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{F.id}\<%
\\
%
\>[29]\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{homImgAB-from-B}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[23]\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟿}}\AgdaSpace{}%
\AgdaFunction{homImg}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{homAB}\<%
\\
%
\>[4]\AgdaFunction{homImgAB-from-B}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[2428I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{b}%
\>[2433I]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\<%
\\
\>[2433I][@{}l@{\AgdaIndent{0}}]%
\>[46]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaFunction{homBA}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\<%
\\
%
\>[46]\AgdaFunction{right-inverse-of}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{bij}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b}\<%
\\
\>[.][@{}l@{}]\<[2428I]%
\>[31]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cong}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{F.id}\<%
\\
%
\>[31]\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{homImgAB-to-B-Surj}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Surjective}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{homImgAB-to-B}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{homImgAB-to-B-Surj}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[2458I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{from}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{homImgAB-from-B}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
\>[.][@{}l@{}]\<[2458I]%
\>[34]\AgdaSymbol{;}%
\>[2463I]\AgdaField{right-inverse-of}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[2463I]%
\>[36]\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Setoid.refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{Algebra.⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[34]\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{Kernel}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}%
\>[2480I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\<%
\\
\>[2480I][@{}l@{\AgdaIndent{0}}]%
\>[29]\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[29]\AgdaRecord{Congruence}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{ℓ₃}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[0]\AgdaFunction{Kernel}%
\>[2500I]\AgdaSymbol{\{}\AgdaArgument{ℓ₄}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[2500I]%
\>[7]\AgdaKeyword{record}%
\>[2509I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{rel}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{krel}\<%
\\
\>[.][@{}l@{}]\<[2509I]%
\>[14]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{welldef}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{\{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{(}\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{krelWdef}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\>[14]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cequiv}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{krelEquiv}\<%
\\
%
\>[14]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{csubst}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{krsubst}\<%
\\
%
\>[14]\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[2540I]\AgdaFunction{krel}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ARel}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{ℓ₄}\<%
\\
\>[.][@{}l@{}]\<[2540I]%
\>[8]\AgdaFunction{krel}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{a₁}\AgdaSpace{}%
\AgdaBound{a₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a₁}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{a₂}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{krelWdef}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[2570I]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x₁}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaBound{y₁}\AgdaSpace{}%
\AgdaBound{y₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{Carrier}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2570I]%
\>[19]\AgdaOperator{\AgdaField{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{y₁}\AgdaSpace{}%
\AgdaBound{y₂}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[19]\AgdaFunction{krel}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaBound{y₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{krel}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaBound{y₂}\<%
\\
%
\>[8]\AgdaFunction{krelWdef}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x₁}\AgdaSymbol{\}}%
\>[2608I]\AgdaSymbol{\{}\AgdaBound{x₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{eqx}\AgdaSpace{}%
\AgdaBound{eqy}\AgdaSpace{}%
\AgdaBound{x₁ry₁}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[2608I]%
\>[24]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[24][@{}l@{\AgdaIndent{0}}]%
\>[26]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{x₂}\<%
\\
%
\>[26]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaFunction{Setoid.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{eqx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[26]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{x₁}\<%
\\
%
\>[26]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaBound{x₁ry₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[26]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{y₁}\<%
\\
%
\>[26]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{eqy}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[26]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{y₂}\<%
\\
\>[24][@{}l@{\AgdaIndent{0}}]%
\>[25]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{EqR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{krelEquiv}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}%
\>[32]\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{IsEquivalence}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{krel}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\})}\<%
\\
%
\>[8]\AgdaFunction{krelEquiv}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[2673I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Setoid.refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2673I]%
\>[29]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{sym}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Setoid.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\>[29]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{trans}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Setoid.trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\>[8]\AgdaFunction{krsubst}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[2697I]\AgdaSymbol{\{}\AgdaBound{ar}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ops}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ar}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2697I]%
\>[18]\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}∼v\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{R}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{krel}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=[}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]⇒}}\AgdaSpace{}%
\AgdaFunction{krel}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\<%
\\
%
\>[8]\AgdaFunction{krsubst}%
\>[2726I]\AgdaSymbol{\{}\AgdaArgument{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{vs₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{vs₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[2726I]%
\>[16]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[19]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{vs₁}\AgdaSymbol{)}\<%
\\
%
\>[19]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{vs₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[19]\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{vs₁}\AgdaSymbol{))}\<%
\\
%
\>[19]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{p}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[19]\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{vs₂}\AgdaSymbol{))}\<%
\\
%
\>[19]\AgdaOperator{\AgdaFunction{≈⟨}}\AgdaSpace{}%
\AgdaFunction{Setoid.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{cond}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{vs₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[19]\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{vs₂}\AgdaSymbol{)}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[17]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{where}%
\>[2799I]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{EqR}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2799I]%
\>[16]\AgdaFunction{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}%
\>[2807I]\AgdaSymbol{\{}\AgdaBound{is}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{w}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}∼v\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{R}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{krel}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{is}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{is}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2807I]%
\>[22]\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}∼v\AgdaUnderscore{}}}%
\>[2821I]\AgdaSymbol{\{}\AgdaArgument{R}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s'}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{is}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{is}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[2821I]%
\>[27]\AgdaSymbol{(}\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\<%
\\
%
\>[27]\AgdaSymbol{(}\AgdaFunction{map⟿}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaFunction{p}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaInductiveConstructor{∼⟨⟩}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{∼⟨⟩}\<%
\\
%
\>[16]\AgdaFunction{p}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{is}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{∼▹}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{eq₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{∼▹}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{p}\AgdaSpace{}%
\AgdaBound{eq₁}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Congruence}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product.Relation.Pointwise.NonDependent}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{×-setoid}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{isEpi}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[9]\AgdaSymbol{∀}%
\>[2867I]\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[2867I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{\{}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[0]\AgdaFunction{isEpi}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{sorts}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Surjective}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{QuotHom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSymbol{\}}%
\>[2909I]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[2909I][@{}l@{\AgdaIndent{0}}]%
\>[24]\AgdaSymbol{(}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Congruence}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{QuotHom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}%
\>[2931I]\AgdaOperator{\AgdaField{′\AgdaUnderscore{}′}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fₕ}\<%
\\
\>[2931I][@{}l@{\AgdaIndent{0}}]%
\>[25]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{condₕ}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[2938I]\AgdaFunction{fₕ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟿}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2938I]%
\>[8]\AgdaFunction{fₕ}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[2948I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{F.id}\<%
\\
\>[.][@{}l@{}]\<[2948I]%
\>[22]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cong}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{PC-resp-\textasciitilde{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{S}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{rel}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{welldef}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{cequiv}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{IsEquivalence}\<%
\\
%
\>[8]\AgdaFunction{condₕ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{homCond}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{fₕ}\<%
\\
%
\>[8]\AgdaFunction{condₕ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ar}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{as}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[2986I]\AgdaFunction{PE.subst}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaField{rel}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{))}\<%
\\
\>[2986I][@{}l@{\AgdaIndent{0}}]%
\>[36]\AgdaSymbol{(}\AgdaFunction{PE.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PE.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map-id}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)))}\<%
\\
%
\>[36]\AgdaSymbol{(}\AgdaField{IsEquivalence.refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{cequiv}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Monomorphism from any sub-algebra of A to A -\}}\<%
\\
\>[0]\AgdaFunction{sub-embedding}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}%
\>[3010I]\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[3010I][@{}l@{\AgdaIndent{0}}]%
\>[24]\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{SubAlg}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SubAlgebra}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[0]\AgdaFunction{sub-embedding}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}%
\>[3032I]\AgdaOperator{\AgdaField{′\AgdaUnderscore{}′}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaKeyword{record}\<%
\\
\>[.][@{}l@{}]\<[3032I]%
\>[4]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{proj₁}\<%
\\
%
\>[4]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cong}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{F.id}\<%
\\
%
\>[4]\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{\AgdaUnderscore{}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{as}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Setoid.refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Monomorphism from the quotient algebra to the target algebra -\}}\<%
\\
\>[0]\AgdaFunction{ker-embedding}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaFunction{Kernel}\AgdaSpace{}%
\AgdaBound{h}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{B}\<%
\\
\>[0]\AgdaFunction{ker-embedding}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}%
\>[3093I]\AgdaOperator{\AgdaField{′\AgdaUnderscore{}′}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaKeyword{record}\<%
\\
\>[.][@{}l@{}]\<[3093I]%
\>[4]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩\AgdaUnderscore{}}}\<%
\\
%
\>[4]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cong}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{F.id}\<%
\\
%
\>[4]\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaBound{H}\<%
\\
%
\>[2]\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Restriction of an homomorphism to a sub-algebra -\}}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↾\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSpace{}%
\AgdaBound{ℓ₂}\AgdaSpace{}%
\AgdaBound{ℓ₃}\AgdaSpace{}%
\AgdaBound{ℓ₄}\AgdaSpace{}%
\AgdaBound{ℓ₅}\AgdaSymbol{\}}%
\>[3120I]\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[3120I][@{}l@{\AgdaIndent{0}}]%
\>[26]\AgdaSymbol{\{}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Algebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₃}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₄}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[3120I]%
\>[25]\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[25][@{}l@{\AgdaIndent{0}}]%
\>[26]\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{SubAlg}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ₅}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[25]\AgdaRecord{Homo}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SubAlgebra}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{B}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↾\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}%
\>[3149I]\AgdaSymbol{\{}\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′\AgdaUnderscore{}′}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[3149I][@{}l@{\AgdaIndent{0}}]%
\>[15]\AgdaKeyword{record}%
\>[3160I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟨\$⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaField{proj₁}\<%
\\
\>[.][@{}l@{}]\<[3160I]%
\>[22]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cong}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[32]\AgdaField{Π.cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\>[22]\AgdaSymbol{\}}\<%
\\
%
\>[15]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{↾-cond}\<%
\\
%
\>[15]\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[3179I]\AgdaFunction{↾-cond}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[3181I]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ar}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ops}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ar}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{↦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{as}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[3181I]%
\>[17]\AgdaSymbol{((}\AgdaBound{B}%
\>[3193I]\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₛ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{≈}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{SubAlgebra}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[3193I]%
\>[21]\AgdaSymbol{((}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₒ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩}}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[3179I]%
\>[8]\AgdaFunction{↾-cond}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ar}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{as}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{PE.sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map-compose}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaField{′}}%
\>[66]\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟨\$⟩\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{cond}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{as}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\<%
\end{code}
\end{document}
