{- Free Algebra over a set -}
open import UnivAlgebra
open import Level renaming (zero to lzero ; suc to lsuc)
module FreeAlgebra (Î£ : Signature) {â„“â‚ â„“â‚‚} (ğ“’ : AlgClass {â„“â‚} {â„“â‚‚} Î£) where
import SubAlgebra

open import Setoids
open import Morphisms
open import Function.Injection
open import Relation.Binary hiding (Total)
open import Data.Product hiding (Î£)

open Signature
open import Function.Equality renaming (_âˆ˜_ to _âˆ˜â‚‘_) 
open Algebra
open Universe Î£

module UMP {â„“â‚ â„“â‚‚} {A : Algebra {â„“â‚} {â„“â‚‚} Î£} where
  open SubAlgebra Î£ A
  open Setoid

  UMP : âˆ€ {â„“â‚ƒ â„“â‚„ â„“â‚… â„“â‚†} {X : Universe â„“â‚ƒ â„“â‚„} â†’
        (X âŠ†â‚› (A âŸ¦_âŸ§â‚›)) â†’ Algebra {â„“â‚…} {â„“â‚†} Î£ â†’ Set _
  UMP {X = X} XâŠ†A B = (f : X âŸ¶â‚› (B âŸ¦_âŸ§â‚›)) â†’ âˆƒ! _â‰ˆâ‚•_ (Pr f)
    where open Hom A B
          open Homo
          Î¹ : X âŸ¶â‚› (A âŸ¦_âŸ§â‚›)
          Î¹ s = to 
            where open Injection (XâŠ†A {s})
          Pr : X âŸ¶â‚› (B âŸ¦_âŸ§â‚›) â†’ Homo â†’ Set _
          Pr f H = âˆ€ s x â†’ Setoid._â‰ˆ_ (B âŸ¦ s âŸ§â‚›) (f s âŸ¨$âŸ© x) (â€² H â€² s âˆ˜â‚‘ Î¹ s âŸ¨$âŸ© x)

open SubAlgebra using (_âŠ†â‚›_)

{- A is free on ğ“’ over X if A is generated by X and 
       A satisfies the UMP for any other B in ğ“’. -}

_is-Free-over_ : âˆ€ {â„“â‚ƒ} {â„“â‚„} {X : Universe â„“â‚ƒ â„“â‚„} (A : Algebra {â„“â‚} {â„“â‚‚} Î£) {CA : ğ“’ A} â†’
                 (_âŠ†â‚›_ Î£ A X (A âŸ¦_âŸ§â‚›)) â†’ Set _
A is-Free-over X = IsGeneratedBy (Img X) Ã— (âˆ€ B â†’ (CB : ğ“’ B) â†’ UMP X B)
  where open UMP {A = A}
        open SubAlgebra Î£ A

-- Alternative:
-- Asume that X is a predicate over A
-- say that A is free in ğ“’ over X if
--   âˆ€ B â†’ ğ“’ B â†’ (âˆ€ h : A â†’ B) â†’ âˆƒ ! G : Homo (âŸ¨ X âŸ© A) B st for all (a :A), X a â†’ h a = G a
